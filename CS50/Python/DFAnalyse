import pandas

class Analyse(object):

    def __init__(self, df):
        self.df = df
        self.keys = list(df)
        self.length = len(df)
    
    def get_keys(self):
        return self.keys
    
    def get_len(self):
        return self.length
    
    def get_type(self, key):
        return type(self.df[key][0])
    
    def col_list(self, key):
        return list(self.df[key])
    
    def select_equal(self, col, quant):
        self.df = df.loc[df[col] == quant]
        self.length = len(self.df)
    
    def select_more_less(self, col, quant, more_than = True):
        if more_than:
            self.df = df.loc[df[col] > quant]
        else:
            self.df = df.loc[df[col] <= quant]
        self.length = len(self.df)
    
    def select_list(self, col, list_quant):
        self.df = self.df.loc[df[col].isin(list_quant)]
        self.length = len(self.df)
    
    def avg(self, col):
        the_list = list(self.df[col])
        return (sum(the_list)/len(the_list))
    
    def of_each(self, itter, height, avg = False):
        units = set(list(df[itter]))
        heights = []
        for unit in units:
            bar = df.loc[df[itter] == unit]
            bar = bar[height]
            if avg:
                bar = sum(bar)/len(bar)
            else:
                bar = sum(bar)
            heights.append(bar)
        return heights, units
    
    def genre_count(self):
        genres = {}
        for movie in self.df["genre"]:
            for gen in movie.split(','):
                gen = gen.strip()
                if gen in genres:
                    genres[gen] += 1
                else:
                    genres[gen] = 1
        return genres